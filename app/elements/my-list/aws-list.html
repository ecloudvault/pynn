<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<dom-module id="aws-list">
  <style>
    :host {
      display: block;
    }

    .iron-selected {
      background: #eee;
    }
  </style>
  <template>
    <section>
    <iron-selector selected="{{selectedvideo}}">
      <template is="dom-repeat" items="{{items}}">
        <div class="item" on-tap="showSource">{{item.VideoID.S}}</div>
      </template>
    </iron-selector>
    </section>
    <h3>{{selectedvideo}}</h3>
    <h3 id="vsrc">{{vsource}}</h3>
  </template>

  <script>
    (function () {
      Polymer({
        is: 'aws-list',
        properties: {
          selectedvideo: {
            type: Number,
            notify: true,
          },
          items: {
            type: Array,
            notify: true,
          },
          vsource: {
            computed: 'vurl()'
          }
        },

        vurl: function() {
          this.vsource = this.items[this.selectedvideo].Streampath.S;
        },

        showSource: function(e) {
          this.$.vsrc.textContent = e.model.item.Streampath.S;
        },

        ready: function() {
            var db = new AWS.DynamoDB( {apiVersion: '2012-08-10', region: 'us-west-2', accessKeyId: 'AKIAIOAPI7JRYJUHZKFQ', secretAccessKey: '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'} );
            var parms = { TableName: 'VideoLibrary', IndexName: 'org-owner-index', KeyConditionExpression: 'Organization = :val', ExpressionAttributeValues: { ':val': { S: 'ecloudvault' } } };
            
            db.query( parms, function(err, data) {
              if (err) {
                console.log(err);
              }
              else {
                console.log(data);
                var awsl = document.getElementById('joe');
                awsl.items = data.Items;
              }
            });
        }
      });
    })();
  </script>

</dom-module>
